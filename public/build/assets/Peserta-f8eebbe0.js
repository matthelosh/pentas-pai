import{r as l,o as b,c as v,b as e,a as j,u as g,t as h,d as R,i as D,G,F as P,l as L,e as U,E as O,j as F,K as Q,n as X,f as w,k as H,v as M,m as E,h as ee,w as te,Z as se,R as le,S as oe,U as q,P as J}from"./app-6686f679.js";import{_ as ae}from"./Dash-485831fb.js";import{i as W,r as ne,u as re}from"./xlsx-e33107bf.js";import{Q as ie,m as de,S as z,A as Y,d as ue,f as ce}from"./mdi-d71a3133.js";import{b as pe,c as Z}from"./chunk-7461cf73.js";import{b as he,c as be,t as fe,a as ve}from"./_baseIteratee-e1418dfa.js";import{i as me}from"./isArrayLike-4aa94e85.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./isSymbol-80af4f08.js";import"./_baseIsEqual-61354f41.js";function ge(r){var d=r==null?0:r.length;return d?r[d-1]:void 0}function _e(r,d){return d.length<2?r:he(r,pe(d,0,-1))}function xe(r,d){return d=be(d,r),r=_e(r,d),r==null||delete r[fe(ge(d))]}var ye=Array.prototype,ke=ye.splice;function we(r,d){for(var n=r?d.length:0,f=n-1;n--;){var c=d[n];if(n==f||c!==_){var _=c;me(c)?ke.call(r,c,1):xe(r,c)}}return r}function $e(r,d){var n=[];if(!(r&&r.length))return n;var f=-1,c=[],_=r.length;for(d=ve(d);++f<_;){var $=r[f];d($,f,r)&&(n.push($),c.push(f))}return we(r,c),n}const Ce={class:"dialog min-w-[400px] min-h-[250px] rounded-xl shadow bg-white flex items-center justify-center"},je={class:"w-full px-4"},Pe={class:"text-xl text-gray-800 mb-4 text-center"},Ne={__name:"DialogBox",setup(r,{expose:d}){const n=l(!1);l([]);const f=l(""),c=l(null),_=l(null),$=async(k,y)=>(n.value=!0,f.value=k,new Promise((s,m)=>{c.value=s,_.value=m})),x=()=>{n.value=!1,c.value(!0)},N=()=>{n.value=!1,c.value(!1)};return d({open:$}),(k,y)=>n.value?(b(),v("div",{key:0,class:"overlay fixed top-0 right-0 bottom-0 left-0 z-50 bg-black bg-opacity-50 flex items-center justify-center",onClick:y[0]||(y[0]=R(s=>n.value=!1,["self"]))},[e("div",Ce,[e("div",je,[j(g(ie),{class:"text-red-400 h-32 animate-bounce mx-auto"}),e("h1",Pe,h(f.value),1),e("div",{class:"flex justify-around gap-2 w-full"},[e("button",{onClick:N,class:"px-3 py-2 rounded hover:bg-red-600 active:bg-orange-400 bg-red-400 text-white"},"Batal"),e("button",{onClick:x,class:"px-3 py-2 rounded hover:bg-sky-600 active:bg-orange-400 bg-sky-400 text-white"},"Yakin")])])])])):D("",!0)}},Se={class:"dialog min-w-[400px] min-h-[400px] rounded shadow bg-white"},Le=e("h3",null,"Cek Calon Peserta",-1),De={class:"content p-3"},Ue={class:"table table-responsive w-full"},Fe={class:"table w-full border-collapse"},Ie=e("thead",null,[e("tr",null,[e("th",{class:"border text-center"},"No"),e("th",{class:"border text-center"},"NISN"),e("th",{class:"border text-center"},"Nama"),e("th",{class:"border text-center"},"JK"),e("th",{class:"border text-center"},"Sekolah"),e("th",{class:"border text-center"},"Lomba")])],-1),Ve={class:"border p-2"},Ae={class:"border p-2"},Be={class:"border p-2"},Ke={class:"border p-2"},Je={class:"border p-2"},Me={class:"border p-2"},Re={class:"w-full bg-gray-200 flex items-center justify-between pl-3"},Te={class:"flex items-center h-full flex-wrap"},Oe=["onClick"],ze={__name:"ImportTable",setup(r,{expose:d}){const n=l(!1),f=l(null),c=l(null),_=l("");l("Halo"),l(!1);const $=async()=>{await F.post(route("dashboard.peserta.impor"),{data:x.value}).then(s=>{n.value=!1,f.value(!0)}).catch(s=>console.log(s))};let x=l([]);const N=async(s,m)=>(n.value=!0,x.value=m,_.value=s,new Promise((p,C)=>{f.value=p,c.value=C})),k=l(1),y=G(()=>{x.value.length;let s=Z(x.value,10);return{current:s[k.value-1],pageCount:s.length}});return d({open:N}),(s,m)=>n.value?(b(),v("div",{key:0,class:"overlay fixed top-0 right-0 bottom-0 left-0 z-50 bg-black bg-opacity-50 flex items-center justify-center",onClick:m[2]||(m[2]=R(p=>n.value=!1,["self"]))},[e("div",Se,[e("div",{class:"toolbar bg-gray-100 flex items-center justify-between p-2"},[Le,e("div",{class:"item-toolbars"},[e("button",{class:"py-1 px-2 rounded bg-sky-400 text-white hover:bg-sky-600 active:bg-orange-400 transition-all duration-150 delay-50",onClick:$},"Impor")])]),e("div",De,[e("div",Ue,[e("table",Fe,[Ie,e("tbody",null,[(b(!0),v(P,null,L(g(y).current,(p,C)=>(b(),v("tr",{class:"odd:bg-gray-50",key:C},[e("td",Ve,h(C+1),1),e("td",Ae,h(p.nisn),1),e("td",Be,h(p.nama),1),e("td",Ke,h(p.jk),1),e("td",Je,h(p.sekolah_id),1),e("td",Me,[U(" | "+h(p.lomba_id)+" ",1),e("ul",null,[(b(!0),v(P,null,L(p.bidangs,(I,V)=>(b(),v("li",{key:V},h(I.label),1))),128))])])]))),128))])]),e("div",Re,[U(" Jml Halaman: "+h(g(y).pageCount)+" ",1),e("div",Te,[e("button",{onClick:m[0]||(m[0]=p=>k.value-=1),class:"flex justify-center w-8 border border-gray-500"},"<"),(b(!0),v(P,null,L(g(y).pageCount,p=>(b(),v("button",{key:p,class:O(["flex justify-center w-8 border border-gray-500",p==k.value?"bg-sky-600 text-white":""]),onClick:C=>k.value=p},h(p),11,Oe))),128)),e("button",{onClick:m[1]||(m[1]=p=>k.value+=1),class:"flex justify-center w-8 border border-gray-500"},">")])])])])])])):D("",!0)}},He=["onClick"],Ee={class:"grid grid-cols-1 md:grid-cols-2 md:p-10 md:gap-5 relative bg-gray-50 w-[90vw] h-90vh md:w-2/4"},qe={class:"w-full bg-gray-200 p-3 mb-0 md:mb-3 rounded flex flex-col justify-center items-center relative md:static"},Ge=["src"],Qe=e("h1",{class:"text-center text-gray-500 text-lg"},[e("span",{class:"hidden"},[U("Foto Peserta"),e("br")]),e("small",{class:"text-black"},"[Klik gambar untuk mengganti]")],-1),We=["onSubmit"],Ye=e("h3",{class:"text-lg text-gray-700 mt-0 mb-4 font-extrabold"},"Data Peserta",-1),Ze={class:"flex justify-between mb-3"},Xe=e("label",{for:"sekolah"},"Sekolah",-1),et=["value"],tt={class:"flex justify-between mb-3"},st=e("label",{for:"nisn",class:"w-1/4"},"NISN",-1),lt={class:"flex justify-between mb-3"},ot=e("label",{for:"nama",class:"w-1/4"},"Nama",-1),at={class:"flex justify-between mb-3"},nt=e("label",{for:"jk",class:"w-1/4"},"JK",-1),rt={class:"grid grid-cols-2 w-3/4"},it=e("label",{for:"lk",class:"ml-2"},"Laki-laki",-1),dt=e("label",{for:"pr",class:"ml-2"},"Perempuan",-1),ut={class:"flex justify-between mb-3"},ct=e("label",{for:"lomba"},"Lomba",-1),pt=["value","selected"],ht={class:"flex justify-between mb-3"},bt=e("label",{for:"hp",class:"w-1/4"},"No. WA",-1),ft={class:"flex justify-center mb-3"},vt=["disabled"],mt={__name:"FormPeserta",setup(r,{expose:d}){Q();const n=l(null),f=l("/img/peserta.png"),c=l(!1),_=l("edit"),$=u=>{let i=u.target.files[0];f.value=URL.createObjectURL(i),n.value=i},x=l([]),N=l([]),k=l(),y=l(!1),s=l({lomba_id:[]}),m=l(null),p=l(null),C=()=>{y.value=!1},I=u=>(y.value=!0,u!==null?(_.value="edit",s.value={id:u.id,nisn:u.nisn,nama:u.nama,jk:u.jk,sekolah_id:u.sekolah_id,foto:u.foto,hp:u.hp,lomba_id:[]},u.lomba_id.includes(",")?s.value.lomba_id=u.lomba_id.split(","):s.value.lomba_id.push(u.lomba_id),f.value=W(u.foto?u.foto:"/img/peserta.png")):(_.value="new",s.value={lomba_id:[]},f.value="/img/peserta.png"),new Promise((i,t)=>{m.value=i,p.value=t})),V=async()=>{c.value=!0;const u=_.value=="edit"?"dashboard.peserta.update":"peserta.store";let i=new FormData;i.append("data",JSON.stringify(s.value)),n.value!==null&&i.append("foto",n.value),await F.post(route(u,{id:s.value.id}),i).then(t=>{c.value=!1,p.value(!0),y.value=!1}).catch(t=>{c.value=!1,alert("Ada yang salah")})};d({open:I});const B=()=>{F.post(route("bidang.index")).then(u=>{x.value=u.data.bidangs})},T=()=>{F.post(route("sekolah.index")).then(u=>{N.value=u.data.sekolahs})};return X(()=>{B(),T()}),(u,i)=>y.value?(b(),v("div",{key:0,class:"fixed top-0 right-0 bottom-0 left-0 bg-[#33333389] flex items-center justify-center z-50",onClick:R(C,["self"])},[e("div",Ee,[e("div",qe,[j(g(z),{type:"mdi",path:g(de),class:"absolute w-10 text-gray-400 hover:text-gray-600 active:text-white top-4 right-2",onClick:C},null,8,["path"]),e("img",{src:f.value,alt:"Peserta",class:"w-1/2 rounded-full aspect-square object-cover object-top mx-auto shadow transition-all duration-500 hover:shadow-lg hover:shadow-lime-600 cursor-pointer bg-[#fefefe]",onClick:i[0]||(i[0]=t=>u.$refs.foto.click())},null,8,Ge),Qe,e("input",{type:"file",ref:"foto",class:"hidden",onChange:$},null,544)]),e("form",{ref_key:"formRegistrasi",ref:k,onSubmit:R(V,["prevent"]),class:"p-2 h-auto"},[Ye,e("div",Ze,[Xe,w(e("select",{name:"sekolah",class:"rounded-lg w-3/4 p-1 placeholder:text-blue-500 focus:border-blue-500 bg-gray-100",placeholder:"Pilih","onUpdate:modelValue":i[1]||(i[1]=t=>s.value.sekolah_id=t)},[(b(!0),v(P,null,L(N.value,(t,a)=>(b(),v("option",{key:a,value:t.npsn},h(t.nama),9,et))),128))],512),[[H,s.value.sekolah_id]])]),e("div",tt,[st,w(e("input",{type:"text",name:"nisn",class:"rounded-lg w-3/4 p-1 placeholder:text-blue-500 focus:border-blue-500 bg-gray-100",placeholder:"Nomor Induk Siswa Nasional","onUpdate:modelValue":i[2]||(i[2]=t=>s.value.nisn=t)},null,512),[[M,s.value.nisn]])]),e("div",lt,[ot,w(e("input",{type:"text",name:"nama",class:"rounded-lg w-3/4 p-1 placeholder:text-blue-500 focus:border-blue-500 bg-gray-100",placeholder:"Nama Lengkap","onUpdate:modelValue":i[3]||(i[3]=t=>s.value.nama=t)},null,512),[[M,s.value.nama]])]),e("div",at,[nt,e("div",rt,[e("span",null,[w(e("input",{type:"radio",name:"jk",value:"Laki-laki",id:"lk","onUpdate:modelValue":i[4]||(i[4]=t=>s.value.jk=t)},null,512),[[E,s.value.jk]]),it]),e("span",null,[w(e("input",{type:"radio",name:"jk",value:"Perempuan",id:"pr","onUpdate:modelValue":i[5]||(i[5]=t=>s.value.jk=t)},null,512),[[E,s.value.jk]]),dt])])]),e("div",ut,[ct,w(e("select",{name:"lomba",class:"rounded-lg w-3/4 p-1 placeholder:text-blue-500 focus:border-blue-500 bg-gray-100",placeholder:"Pilih","onUpdate:modelValue":i[6]||(i[6]=t=>s.value.lomba_id=t),multiple:""},[(b(!0),v(P,null,L(x.value,(t,a)=>(b(),v("option",{key:a,value:t.kode,selected:t.kode==s.value.lomba_id},h(t.label),9,pt))),128))],512),[[H,s.value.lomba_id]])]),e("div",ht,[bt,w(e("input",{type:"text",name:"hp",class:"rounded-lg w-3/4 p-1 placeholder:text-blue-500 focus:border-blue-500 bg-gray-100",placeholder:"Nomor WA/HP","onUpdate:modelValue":i[7]||(i[7]=t=>s.value.hp=t)},null,512),[[M,s.value.hp]])]),e("div",ft,[e("button",{type:"submit",class:"bg-blue-600 text-white rounded px-3 py-1 hover:bg-blue-800 flex items-center disabled:bg-blue-300 disabled:text-gray-300",disabled:c.value},[c.value?(b(),ee(g(Y),{key:0,class:"animate-spin w-5 mr-1"})):D("",!0),U(" Daftar ")],8,vt)])],40,We)])],8,He)):D("",!0)}},gt={class:"w-full bg-white"},_t={class:"toolbar w-full h-12 bg-gray-50 rounded shadow flex items-center px-0 md:px-3 justify-center md:justify-between print:hidden"},xt=e("h1",{class:"hidden md:inline"},[e("span",null,"Data Peserta")],-1),yt={class:"toolbar-items flex items-center gap-2"},kt={for:"select",class:"mx-3 hidden md:inline"},wt={class:"hidden md:inline"},$t=["disabled"],Ct={key:0,class:"hidden md:inline"},jt=["onKeyup"],Pt={class:"content w-full bg-white p-3 mt-2"},Nt={class:"overflow-x-auto w-full border"},St={class:"w-full table table-responsive border-collapse"},Lt=e("caption",{class:"text-left md:text-center p-2"},[e("h1",{class:"text-xl"},"Data Peserta Lomba")],-1),Dt={class:"border text-center"},Ut=e("th",{class:"border text-center"},"NISN",-1),Ft=e("th",{class:"border text-center"},"Nama",-1),It=e("th",{class:"border text-center"},"JK",-1),Vt=e("th",{class:"border text-center"},"Sekolah",-1),At=e("th",{class:"border text-center"},"Lomba",-1),Bt=e("th",{class:"border text-center print:hidden"},"Opsi",-1),Kt={class:"border p-2"},Jt=["checked","onChange"],Mt={class:"border p-2"},Rt={class:"border p-2"},Tt=["onClick"],Ot=["src"],zt={class:"border p-2"},Ht={class:"border p-2"},Et={class:"border p-2 flex gap-2"},qt={class:"bg-teal-200 px-2 py-1 rounded"},Gt={class:"text-center border p-2 print:hidden"},Qt=["onClick"],Wt={class:"w-full bg-gray-200 flex items-center justify-between px-3 flex-wrap print:hidden"},Yt={class:"flex items-center gap-1"},Zt={class:"w-full flex flex-wrap md:justify-end print:hidden"},Xt=["onClick"],cs={__name:"Peserta",setup(r){const d=Q(),n=l(1),f=l(null),c=l(d.props.pesertas),_=l(!1),$=()=>{c.value=d.props.pesertas.filter(t=>t.nama.toLowerCase().includes(f.value.toLowerCase())||t.nisn.toLowerCase().includes(f.value.toLowerCase())||t.sekolah.nama.toLowerCase().includes(f.value.toLowerCase()))},x=G(()=>{let t=c.value.length,a=Z(c.value,10);return{current:a[n.value-1],pageCount:a.length,total:t}}),N=async()=>{_.value=!0,await F.post(route("dashboard.peserta.attach"),{pesertas:JSON.stringify(d.props.pesertas)}).then(t=>{J.reload({only:["pesertas"]}),_.value=!1})},k=l("Ambil File"),y=async t=>{let a=t.target.files[0];k.value=a.name;let o=new FileReader;o.onload=async A=>{let S=await ne(A.target.result),K=await re.sheet_to_json(S.Sheets[S.SheetNames[0]]);await s.value.open("Cek Calon Peserta",K).then(es=>{J.reload({only:["pesertas"]})})},o.readAsArrayBuffer(a)},s=l(null),m=l(!1),p=l([]),C=t=>{p.value=t.target.checked?c.value:[]},I=t=>p.value.filter(o=>o.nisn==t).length>0,V=(t,a)=>{t.target.checked?p.value.push(a):p.value=$e(p.value,o=>o.nisn==a.nisn)},B=l(null),T=async t=>{await B.value.open("Hapus").then(a=>{a&&F.delete(route("dashboard.peserta.destroy",{id:t})).then(o=>{J.reload({only:["pesertas"]})})})},u=l(null),i=async t=>{await u.value.open(t).then(a=>{a&&J.reload({only:["pesertas"]})})};return(t,a)=>(b(),v(P,null,[j(mt,{ref_key:"formPeserta",ref:u},null,512),j(Ne,{ref_key:"dialog",ref:B},null,512),j(ze,{ref_key:"importTable",ref:s},null,512),j(g(se),{title:"Data Peserta"}),j(ae,null,{default:te(()=>[e("div",gt,[e("div",_t,[xt,e("div",yt,[e("input",{type:"file",name:"filePeserta",id:"filePeserta",ref:"filePeserta",onChange:y,class:"hidden",accept:".xlsx, .xls, .ods, .csv"},null,544),e("label",kt,[w(e("input",{type:"checkbox",name:"select",id:"select",class:"rounded","onUpdate:modelValue":a[0]||(a[0]=o=>m.value=o)},null,512),[[le,m.value]]),U(" Pilih Data ")]),e("button",{class:"bg-green-400 hover:bg-green-600 active:bg-orange-400 text-white py-1 px-2 rounded",onClick:a[1]||(a[1]=o=>i(null))},"Baru"),e("button",{class:"bg-green-400 hover:bg-green-600 active:bg-orange-400 text-white py-1 px-2 rounded flex items-center",onClick:a[2]||(a[2]=o=>t.$refs.filePeserta.click())},[e("span",wt,h(k.value),1),j(g(z),{type:"mdi",path:g(ue)},null,8,["path"])]),e("button",{class:"bg-sky-400 hover:bg-sky-600 text-white px-2 py-1 rounded shadow uppercase flex items-center active:bg-sky-800",disabled:_.value,onClick:N},[_.value?D("",!0):(b(),v("span",Ct,"Daftarkan Bidang Lomba")),j(g(Y),{class:O(["w-6 text-white",_.value?"animate-spin":""])},null,8,["class"])],8,$t),w(e("input",{type:"text",placeholder:"Cari",class:"h-8 rounded w-[60%] md:w-64","onUpdate:modelValue":a[3]||(a[3]=o=>f.value=o),onKeyup:oe($,["enter"])},null,40,jt),[[M,f.value]])])]),e("div",Pt,[e("div",Nt,[e("table",St,[Lt,e("thead",null,[e("tr",null,[e("th",Dt,[w(e("span",null,"No",512),[[q,!m.value]]),m.value?(b(),v("input",{key:0,type:"checkbox",name:"select",id:"select",class:"rounded",onChange:C},null,32)):D("",!0)]),Ut,Ft,It,Vt,At,Bt])]),e("tbody",null,[(b(!0),v(P,null,L(g(x).current,(o,A)=>(b(),v("tr",{class:"odd:bg-gray-50",key:A},[e("td",Kt,[w(e("span",null,h(A+1),513),[[q,!m.value]]),m.value?(b(),v("input",{key:0,type:"checkbox",name:"select",id:"select",class:"rounded",checked:I(o.nisn),onChange:S=>V(S,o)},null,40,Jt)):D("",!0)]),e("td",Mt,h(o.nisn),1),e("td",Rt,[e("div",{class:"h-full grid grid-cols-2 md:flex items-center gap-2 cursor-pointer",onClick:S=>i(o)},[e("img",{src:g(W)(o.foto),alt:"Foto",class:"h-8 aspect-square object-cover object-top rounded-full"},null,8,Ot),U(" "+h(o.nama),1)],8,Tt)]),e("td",zt,h(o.jk),1),e("td",Ht,h(o.sekolah.nama),1),e("td",Et,[e("div",qt,h(o.lomba_id),1),e("ul",null,[(b(!0),v(P,null,L(o.bidangs,(S,K)=>(b(),v("li",{key:K},h(K+1)+". "+h(S.label),1))),128))])]),e("td",Gt,[e("button",{class:"p-0 text-red-400 hover:text-red-600 active:text-orange-400",onClick:S=>T(o.id)},[j(g(z),{type:"mdi",path:g(ce),size:18},null,8,["path"])],8,Qt)])]))),128))])])]),e("div",Wt,[e("div",Yt," Total: "+h(g(x).total),1),U(" Jml Halaman: "+h(g(x).pageCount),1)]),e("div",Zt,[e("button",{onClick:a[4]||(a[4]=o=>n.value-=1),class:"flex justify-center w-8 border border-gray-500 flex-grow md:flex-grow-0"},"<"),(b(!0),v(P,null,L(g(x).pageCount,o=>(b(),v("button",{key:o,class:O(["flex justify-center w-8 border border-gray-500 flex-grow md:flex-grow-0",o==n.value?"bg-sky-600 text-white":""]),onClick:A=>n.value=o},h(o),11,Xt))),128)),e("button",{onClick:a[5]||(a[5]=o=>n.value+=1),class:"flex justify-center w-8 border border-gray-500 flex-grow md:flex-grow-0"},">")])])])]),_:1})],64))}};export{cs as default};
